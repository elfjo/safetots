{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"wp.data\"","webpack:///../node_modules/string-hash/index.js","webpack:///./js/utils/processor.ts","webpack:///../node_modules/@babel/runtime/helpers/typeof.js","webpack:///../node_modules/@babel/runtime/helpers/slicedToArray.js","webpack:///../node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///external \"lodash\"","webpack:///./js/stores/data/controls.ts","webpack:///./js/stores/data/actions.ts","webpack:///./js/stores/data/reducer.ts","webpack:///./js/stores/data/resolvers.ts","webpack:///./js/stores/data/selectors.ts","webpack:///./js/stores/data/index.ts","webpack:///./js/stores/ui/actions.ts","webpack:///./js/stores/ui/reducer.ts","webpack:///./js/stores/ui/selectors.ts","webpack:///./js/stores/ui/index.ts","webpack:///./js/stores/index.ts","webpack:///../node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack:///./js/utils/data.ts","webpack:///./js/utils/element.ts","webpack:///external \"wp.url\"","webpack:///../node_modules/@babel/runtime/helpers/classCallCheck.js","webpack:///./js/utils/dom.ts","webpack:///external \"wp.blocks\"","webpack:///../node_modules/@babel/runtime/helpers/setPrototypeOf.js","webpack:///../node_modules/uuid/v4.js","webpack:///./js/utils/editor.ts","webpack:///../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack:///../node_modules/@babel/runtime/helpers/iterableToArray.js","webpack:///../node_modules/@babel/runtime/helpers/createClass.js","webpack:///../node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack:///./js/utils/ajax.ts","webpack:///../node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack:///../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack:///../node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack:///../node_modules/@babel/runtime/helpers/assertThisInitialized.js","webpack:///../node_modules/@babel/runtime/helpers/getPrototypeOf.js","webpack:///external \"CSL\"","webpack:///./js/utils/cache.ts","webpack:///../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","webpack:///../node_modules/uuid/lib/rng-browser.js","webpack:///../node_modules/uuid/lib/bytesToUuid.js","webpack:///../node_modules/@babel/runtime/helpers/inherits.js","webpack:///../node_modules/@babel/runtime/helpers/asyncToGenerator.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","wp","data","str","hash","length","charCodeAt","Processor","style","_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default","this","sys","retrieveItem","id","item","_wordpress_data__WEBPACK_IMPORTED_MODULE_3__","getItemById","Error","concat","retrieveLocale","lang","locale","utils_cache__WEBPACK_IMPORTED_MODULE_6__","getItem","instance","engine","citeproc__WEBPACK_IMPORTED_MODULE_4__","opt","development_extensions","wrap_url_and_doi","citations","_this","rebuildProcessorState","map","_ref","_ref2","_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default","html","sortedItems","JSON","stringify","registry","citationById","_ref3","makeBibliography","items","meta","_a","_data","_data2","entryspacing","hangingindent","linespacing","maxoffset","secondFieldAlign","undefined","lodash__WEBPACK_IMPORTED_MODULE_5___default","a","zipWith","flatten","entry_ids","content","citationreg","__webpack_exports__","_typeof2","obj","iterator","constructor","_typeof","arrayWithHoles","iterableToArrayLimit","nonIterableRest","arr","configurable","writable","lodash","data_controls","FETCH_CITATION_STYLES","_FETCH_CITATION_STYLES","asyncToGenerator_default","regeneratorRuntime","mark","_callee","response","wrap","_context","prev","next","ajax","sent","abrupt","json","stop","apply","arguments","FETCH_LOCALE","_FETCH_LOCALE","_callee2","_context2","cache","fetchItem","_x","FETCH_STYLE","_FETCH_STYLE","_callee3","_context3","_x2","addReference","addReferences","removeFootnote","removeFootnotes","removeReference","removeReferences","updateReference","removeAllCitations","parseCitations","parseFootnotes","setStyle","save","setBibliography","setFootnotes","updateEditorCitations","_marked","type","_marked2","_marked3","itemIds","doc","removedItems","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","footnote","_context4","editor","querySelectorAll","utils_element","selector","done","includes","parentNode","removeChild","t0","return","finish","external_wp_data_","resetBlocks","external_wp_blocks_","innerHTML","_marked4","_context5","_marked5","toDelete","_context6","toConsumableArray_default","reduce","idsToDelete","citation","existingIds","getItems","filteredItemIds","filter","dataset","_marked6","itemIsCited","_context7","getCitedItems","findIndex","_marked7","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","el","_context8","_marked8","styleXml","processor","_context9","_select$getStyle","getStyle","kind","utils_processor","getCitationsByIndex","bibliography","_marked9","_context10","forEach","createMarker","_marked10","_context11","_marked11","unsubscribe","_context12","editPost","getSerializedState","getNotices","find","removeNotice","savePost","_marked12","blocksList","bibliographyBlock","_context13","getBlocks","block","updateBlockAttributes","clientId","assign","insertBlock","removeBlock","_marked13","footnoteBlockIndex","bibliographyBlockIndex","_context14","getFootnotes","_ref4","_marked14","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_loop","_iterator3","_step3","_context15","_ref5","node","querySelector","dom","legacyClassNames","cls","classNames","attributes","childElementCount","hasChildren","_marked15","INITIAL_STATE","citationStyles","renamed","styles","reducer","state","action","references","newItems","__rest","utils_data","string_hash_default","toString","index","slice","getCitationStyles","resolvers_marked","selectors_getCitationStyles","citationID","citationItems","properties","noteIndex","external_lodash_default","flatMap","uniq","partial","compact","container","document","createElement","marker","className","appendChild","textContent","note","getUncitedItems","getSortedItems","order","orderBy","_$get","issued","_$get2","slicedToArray_default","year","_$get2$","month","_$get2$2","Date","toJSON","title","_abt_state","differenceWith","left","right","stores_data","actions","actions_namespaceObject","controls","resolvers","resolvers_namespaceObject","selectors","selectors_namespaceObject","clearSelectedItems","setIdentifierKind","setSidebarSortMode","setSidebarSortOrder","toggleItemSelected","ARD_INITIAL_STATE","identifierKind","SIDEBAR_INITIAL_STATE","selectedItems","sortMode","sortOrder","getIdentifierKind","addReferenceDialog","getSelectedItems","sidebar","getSidebarSortMode","getSidebarSortOrder","ui","ui_actions_namespaceObject","ui_selectors_namespaceObject","arrayWithoutHoles","iterableToArray","nonIterableSpread","clone","parse","firstTruthyValue","paths","fallback","path","val","lodash__WEBPACK_IMPORTED_MODULE_1___default","err","swapWith","b","list","_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default","splice","CitationElement","CitationElement_1","_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default","uuid_v4__WEBPACK_IMPORTED_MODULE_4___default","contentEditable","innerText","outerHTML","reflist","utils_dom__WEBPACK_IMPORTED_MODULE_5__","__decorate","_cons","FootnoteElement","FootnoteElement_1","markers","url","Constructor","TypeError","createSelector","_len","Array","_key","element","_ref$classNames","_ref$attributes","_arr","entries","_i","_arr$_i","k","v","join","getJSONScriptData","script","blocks","_setPrototypeOf","setPrototypeOf","__proto__","rng","bytesToUuid","options","buf","offset","rnds","random","ii","INVALID_BLOCK_TYPES","getEditorDOM","excludeInvalid","filteredBlocks","_wordpress_data__WEBPACK_IMPORTED_MODULE_2__","getBlocksForSerialization","isValid","_wordpress_blocks__WEBPACK_IMPORTED_MODULE_1__","getEditedPostContent","parseBibAttributes","data-entryspacing","data-hangingindent","data-maxoffset","data-linespacing","data-second-field-align","stripListItem","child","toRemove","children","classList","contains","trim","isArray","arr2","iter","from","_defineProperties","target","props","descriptor","protoProps","staticProps","fetchAjax","_fetchAjax","body","fetch","top","ajaxurl","method","headers","Content-type","_wordpress_url__WEBPACK_IMPORTED_MODULE_1__","_","_wpnonce","_abt_nonce","credentials","_n","_d","_e","_s","push","self","ReferenceError","_getPrototypeOf","getPrototypeOf","CSL","AbstractCache","daysTilExpiration","_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_6___default","PREFIX","VERSION","KEY","_cache","storageIsAvailable","localStorage","createFallbackStorage","ITEM_KEY","EXPIRES","now","keys","startsWith","removeItem","lodash__WEBPACK_IMPORTED_MODULE_8___default","omit","_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_5___default","storage","window","setItem","_value","Map","size","clear","_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_4___default","delete","set","expires","localeCache","_AbstractCache","_class","_this2","parser","DOMParser","_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_3___default","_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_7___default","_fetchItem","_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0___default","xml","styleNode","localeId","parseFromString","getAttribute","ok","statusText","text","styleCache","_AbstractCache2","_class2","_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_1___default","_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_2___default","_fetchItem2","styleId","cached","assertThisInitialized","getRandomValues","crypto","msCrypto","rnds8","Uint8Array","Math","byteToHex","substr","bth","subClass","superClass","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","Promise","then","fn","args"],"mappings":"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","file":"bundle/editor-stores.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 176);\n","module.exports = wp.data;","\"use strict\";\n\nfunction hash(str) {\n  var hash = 5381,\n      i    = str.length;\n\n  while(i) {\n    hash = (hash * 33) ^ str.charCodeAt(--i);\n  }\n\n  /* JavaScript does bitwise operations (like XOR, above) on 32-bit signed\n   * integers. Since we want the results to be always positive, convert the\n   * signed int to an unsigned by doing an unsigned bitshift. */\n  return hash >>> 0;\n}\n\nmodule.exports = hash;\n","import { select } from '@wordpress/data';\nimport { Bibliography as RawBib, Bibmeta, Citation, Engine } from 'citeproc';\nimport _ from 'lodash';\n\nimport { localeCache } from 'utils/cache';\n\nnamespace Processor {\n    export interface BibItem {\n        content: string;\n        id: string;\n    }\n\n    export type BibMeta = Partial<\n        Pick<\n            Bibmeta,\n            'entryspacing' | 'hangingindent' | 'linespacing' | 'maxoffset'\n        > & {\n            secondFieldAlign: Bibmeta['second-field-align'];\n        }\n    >;\n\n    export interface Bibliography {\n        items: BibItem[];\n        meta: BibMeta;\n    }\n\n    export interface CitationMeta {\n        /**\n         * ID of the citation HTMLElement.\n         */\n        id: string;\n        /**\n         * Parsed citation HTML to set as the citation HTMLElement innerHTML.\n         */\n        html: string;\n        /**\n         * A JSON stringified list of the sorted item ids in the citation.\n         */\n        sortedItems: string;\n    }\n}\nclass Processor {\n    private static instance: Processor | null = null;\n    private style!: string;\n    private engine!: Engine;\n\n    private sys: Engine['sys'] = {\n        retrieveItem(id: string): CSL.Data {\n            const item = select('abt/data').getItemById(id);\n            if (!item) {\n                throw new Error(\n                    `CSL Data could not be found for item ID \"${id}\"`,\n                );\n            }\n            return item;\n        },\n        retrieveLocale(lang: string) {\n            const locale = localeCache.getItem(lang);\n            if (!locale) {\n                throw new Error(\n                    `Requested locale \"${lang}\" was not prefetched`,\n                );\n            }\n            return locale;\n        },\n    };\n\n    constructor(style: string) {\n        const { instance } = Processor;\n        if (instance) {\n            if (instance.style !== style) {\n                instance.style = style;\n                instance.engine = new Engine(instance.sys, instance.style);\n                instance.engine.opt.development_extensions.wrap_url_and_doi = true;\n            }\n            return instance;\n        } else {\n            Processor.instance = this;\n            this.style = style;\n            this.engine = new Engine(this.sys, this.style);\n            this.engine.opt.development_extensions.wrap_url_and_doi = true;\n        }\n    }\n\n    parseCitations(citations: Citation[]): Processor.CitationMeta[] {\n        return this.engine\n            .rebuildProcessorState(citations)\n            .map(([id, , html]) => {\n                const sortedItems = JSON.stringify(\n                    this.registry.citationById[id].sortedItems.map(\n                        ([ref]) => ref.id,\n                    ),\n                );\n                return {\n                    id,\n                    html,\n                    sortedItems,\n                };\n            });\n    }\n\n    get bibliography(): Processor.Bibliography {\n        let data: RawBib | false;\n        try {\n            data = this.engine.makeBibliography();\n            if (!data) {\n                return { items: [], meta: {} };\n            }\n        } catch {\n            return { items: [], meta: {} };\n        }\n        const [meta, html] = data;\n        const {\n            entryspacing,\n            hangingindent,\n            linespacing,\n            maxoffset,\n            ['second-field-align']: secondFieldAlign,\n        } = meta;\n        return {\n            meta: {\n                entryspacing,\n                hangingindent,\n                linespacing,\n                maxoffset,\n                secondFieldAlign: secondFieldAlign\n                    ? secondFieldAlign\n                    : undefined,\n            },\n            items: _.zipWith(\n                _.flatten(meta.entry_ids),\n                html,\n                (id, content) => ({\n                    id,\n                    content,\n                }),\n            ),\n        };\n    }\n\n    private get registry() {\n        return this.engine.registry.citationreg;\n    }\n}\n\nexport default Processor;\n","function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","module.exports = lodash;","import { Action, select } from '@wordpress/data';\n\nimport { fetchAjax } from 'utils/ajax';\nimport { localeCache, styleCache } from 'utils/cache';\n\nimport { StyleJSON } from './';\nimport { StyleKind } from './constants';\n\nconst enum CtrlActions {\n    FETCH_CITATION_STYLES = 'FETCH_CITATION_STYLES',\n    FETCH_LOCALE = 'FETCH_LOCALE',\n    FETCH_STYLE = 'FETCH_STYLE',\n}\n\nexport function fetchCitationStyles() {\n    return {\n        type: CtrlActions.FETCH_CITATION_STYLES,\n    };\n}\n\nexport function fetchLocale(style: string) {\n    return {\n        type: CtrlActions.FETCH_LOCALE,\n        style,\n    };\n}\n\nexport function fetchStyle() {\n    const { value, kind } = select('abt/data').getStyle();\n    if (kind === StyleKind.CUSTOM) {\n        return value;\n    }\n    return {\n        type: CtrlActions.FETCH_STYLE,\n        id: value,\n    };\n}\n\nconst controls = {\n    async FETCH_CITATION_STYLES(): Promise<StyleJSON> {\n        const response = await fetchAjax('get_style_json');\n        return response.json();\n    },\n    async FETCH_LOCALE({ style }: Action): Promise<string> {\n        return localeCache.fetchItem(style);\n    },\n    async FETCH_STYLE({ id }: Action): Promise<string> {\n        return styleCache.fetchItem(id);\n    },\n};\n\nexport default controls;\n","import { Block, createBlock, parse } from '@wordpress/blocks';\nimport { dispatch, select, subscribe } from '@wordpress/data';\n\nimport { createSelector } from 'utils/dom';\nimport { getEditorDOM } from 'utils/editor';\nimport { CitationElement, FootnoteElement } from 'utils/element';\nimport Processor from 'utils/processor';\n\nimport { Style } from './';\nimport { Actions } from './constants';\nimport { fetchLocale, fetchStyle } from './controls';\n\nexport function* addReference(data: CSL.Data) {\n    yield addReferences([data]);\n}\n\nexport function* addReferences(data: CSL.Data[]) {\n    yield {\n        type: Actions.ADD_REFERENCES,\n        data,\n    };\n    yield save();\n}\n\nexport function* removeFootnote(id: string) {\n    yield removeFootnotes([id]);\n}\n\nexport function* removeFootnotes(itemIds: string[]) {\n    const doc = getEditorDOM();\n    let removedItems = 0;\n    for (const footnote of doc.querySelectorAll(FootnoteElement.selector)) {\n        if (itemIds.includes(`${footnote.id}-ref`) && footnote.parentNode) {\n            footnote.parentNode.removeChild(footnote);\n            removedItems++;\n        }\n    }\n    if (removedItems > 0) {\n        yield dispatch('core/editor').resetBlocks(parse(doc.innerHTML));\n        yield save();\n    }\n}\n\nexport function* removeReference(id: string) {\n    yield removeReferences([id]);\n}\n\nexport function* removeReferences(itemIds: string[]) {\n    const doc = getEditorDOM();\n    const toDelete = [\n        ...doc.querySelectorAll<HTMLSpanElement>(CitationElement.selector),\n    ].reduce((idsToDelete, citation) => {\n        const existingIds = CitationElement.getItems(citation);\n        const filteredItemIds = existingIds.filter(id => !itemIds.includes(id));\n        if (filteredItemIds.length === 0 && citation.parentNode) {\n            citation.parentNode.removeChild(citation);\n        } else {\n            citation.dataset.items = JSON.stringify(filteredItemIds);\n        }\n        return idsToDelete.filter(id => !existingIds.includes(id));\n    }, [...itemIds]);\n\n    yield dispatch('core/editor').resetBlocks(parse(doc.innerHTML));\n    if (toDelete.length > 0) {\n        yield {\n            type: Actions.REMOVE_REFERENCES,\n            itemIds: toDelete,\n        };\n        yield save();\n    }\n}\n\nexport function* updateReference(data: CSL.Data) {\n    const itemIsCited =\n        select('abt/data')\n            .getCitedItems()\n            .findIndex(item => item.id === data.id) >= 0;\n    yield {\n        type: Actions.UPDATE_REFERENCE,\n        data,\n    };\n    if (itemIsCited) {\n        yield parseCitations();\n    }\n    yield save();\n}\n\nexport function* removeAllCitations() {\n    const doc = getEditorDOM();\n    for (const el of doc.querySelectorAll(CitationElement.selector)) {\n        if (el.parentNode) {\n            el.parentNode.removeChild(el);\n        }\n    }\n    yield dispatch('core/editor').resetBlocks(parse(doc.innerHTML));\n}\n\nexport function* parseCitations() {\n    const styleXml: string = yield fetchStyle();\n    yield fetchLocale(styleXml);\n    const processor = new Processor(styleXml);\n    const citations = processor.parseCitations(\n        select('abt/data').getCitationsByIndex(),\n    );\n    yield setBibliography(processor.bibliography);\n    yield updateEditorCitations(citations);\n}\n\nexport function* parseFootnotes() {\n    const doc = getEditorDOM();\n    doc.querySelectorAll(FootnoteElement.selector).forEach((footnote, i) => {\n        footnote.innerHTML = FootnoteElement.createMarker(i);\n    });\n    yield dispatch('core/editor').resetBlocks(parse(doc.innerHTML));\n    yield setFootnotes();\n}\n\nexport function* setStyle(style: Style) {\n    yield {\n        type: Actions.SET_STYLE,\n        style,\n    };\n    yield parseCitations();\n    yield save();\n}\n\nfunction* save() {\n    yield dispatch('core/editor').editPost(\n        select('abt/data').getSerializedState(),\n    );\n    const unsubscribe = subscribe(() => {\n        const notice = select<Array<{ id: string }>>('core/notices')\n            .getNotices()\n            .find(({ id }) => id === 'SAVE_POST_NOTICE_ID');\n        if (notice) {\n            dispatch('core/notices').removeNotice('SAVE_POST_NOTICE_ID');\n            unsubscribe();\n        }\n    });\n    yield dispatch('core/editor').savePost();\n}\n\nfunction* setBibliography({ items, meta }: Processor.Bibliography) {\n    const blocksList = select<Block[]>('core/editor').getBlocks();\n    const bibliographyBlock = blocksList.find(\n        block => block.name === 'abt/bibliography',\n    );\n    if (items.length > 0 && bibliographyBlock) {\n        yield dispatch('core/editor').updateBlockAttributes(\n            bibliographyBlock.clientId,\n            { ...meta, items },\n        );\n    } else if (items.length > 0 && !bibliographyBlock) {\n        yield dispatch('core/editor').insertBlock(\n            createBlock('abt/bibliography', {\n                ...meta,\n                items,\n            }),\n            blocksList.length,\n            undefined,\n            false,\n        );\n    } else if (items.length === 0 && bibliographyBlock) {\n        yield dispatch('core/editor').removeBlock(bibliographyBlock.clientId);\n    }\n}\n\nfunction* setFootnotes() {\n    const items = select('abt/data').getFootnotes();\n    const blocksList = select<Block[]>('core/editor').getBlocks();\n    const footnoteBlockIndex = blocksList.findIndex(\n        ({ name }) => name === 'abt/footnotes',\n    );\n    const bibliographyBlockIndex = blocksList.findIndex(\n        ({ name }) => name === 'abt/bibliography',\n    );\n    if (items.length > 0 && footnoteBlockIndex >= 0) {\n        yield dispatch('core/editor').updateBlockAttributes(\n            blocksList[footnoteBlockIndex].clientId,\n            { items },\n        );\n    } else if (items.length > 0 && footnoteBlockIndex === -1) {\n        yield dispatch('core/editor').insertBlock(\n            createBlock('abt/footnotes', {\n                items,\n            }),\n            bibliographyBlockIndex > 0\n                ? bibliographyBlockIndex\n                : blocksList.length,\n            undefined,\n            false,\n        );\n    } else if (items.length === 0 && footnoteBlockIndex >= 0) {\n        yield dispatch('core/editor').removeBlock(\n            blocksList[footnoteBlockIndex].clientId,\n        );\n    }\n}\n\nfunction* updateEditorCitations(citations: Processor.CitationMeta[]) {\n    const doc = getEditorDOM();\n    for (const { html, id, sortedItems } of citations) {\n        const node = doc.querySelector<HTMLElement>(\n            createSelector(\n                ...CitationElement.legacyClassNames.map(cls => ({\n                    classNames: [cls],\n                    attributes: { id },\n                })),\n            ),\n        );\n        if (node) {\n            node.innerHTML = html;\n            node.dataset.items = sortedItems;\n            if (node.childElementCount > 0) {\n                node.dataset.hasChildren = 'true';\n            }\n        }\n    }\n    yield dispatch('core/editor').resetBlocks(parse(doc.innerHTML));\n}\n","import { Action, combineReducers } from '@wordpress/data';\nimport hash from 'string-hash';\n\nimport { firstTruthyValue } from 'utils/data';\nimport { getJSONScriptData } from 'utils/dom';\n\nimport { SavedState, State } from './';\nimport { Actions } from './constants';\n\nconst INITIAL_STATE: State = {\n    citationStyles: {\n        renamed: {},\n        styles: [],\n    },\n    ...getJSONScriptData<SavedState>('abt-editor-state'),\n};\n\nexport function citationStyles(\n    state = INITIAL_STATE.citationStyles,\n    action: Action,\n): State['citationStyles'] {\n    switch (action.type) {\n        case Actions.SET_CITATION_STYLES: {\n            return action.styles;\n        }\n        default:\n            return state;\n    }\n}\n\nexport function references(\n    state = INITIAL_STATE.references,\n    action: Action,\n): State['references'] {\n    switch (action.type) {\n        case Actions.ADD_REFERENCES: {\n            const newItems = (<CSL.Data[]>action.data)\n                .map(({ id, ...data }) => ({\n                    ...data,\n                    id: firstTruthyValue(\n                        data,\n                        ['DOI', 'ISBN', 'PMCID', 'PMID'],\n                        hash(JSON.stringify(data)).toString(),\n                    ),\n                }))\n                .filter(\n                    ({ id }) => state.findIndex(item => item.id === id) === -1,\n                );\n            return newItems.length > 0 ? [...state, ...newItems] : state;\n        }\n        case Actions.REMOVE_REFERENCES: {\n            return state.filter(({ id }) => !action.itemIds.includes(id));\n        }\n        case Actions.UPDATE_REFERENCE: {\n            const index = state.findIndex(({ id }) => id === action.data.id);\n            return index === -1\n                ? [...state, action.data]\n                : [\n                      ...state.slice(0, index),\n                      action.data,\n                      ...state.slice(index + 1),\n                  ];\n        }\n        default:\n            return state;\n    }\n}\n\nexport function style(\n    state = INITIAL_STATE.style,\n    action: Action,\n): State['style'] {\n    switch (action.type) {\n        case Actions.SET_STYLE:\n            return action.style;\n        default:\n            return state;\n    }\n}\n\nexport default combineReducers({\n    citationStyles,\n    references,\n    style,\n});\n","import { Actions } from './constants';\nimport { fetchCitationStyles } from './controls';\n\nexport function* getCitationStyles() {\n    const styles = yield fetchCitationStyles();\n    return {\n        type: Actions.SET_CITATION_STYLES,\n        styles,\n    };\n}\n","import { Citation } from 'citeproc';\nimport _ from 'lodash';\n\nimport { clone, firstTruthyValue } from 'utils/data';\nimport { getEditorDOM } from 'utils/editor';\nimport { CitationElement, FootnoteElement } from 'utils/element';\n\nimport { State } from './';\n\nexport function getCitationStyles(state: State): State['citationStyles'] {\n    return clone(state.citationStyles);\n}\n\nexport function getStyle(state: State): State['style'] {\n    return clone(state.style);\n}\n\nexport function getCitationsByIndex(state: State): Citation[] {\n    const doc = getEditorDOM(true);\n    const citations = [\n        ...doc.querySelectorAll<HTMLElement>(CitationElement.selector),\n    ];\n    return citations.map((el, index) => {\n        const citationID = el.id;\n        const citationItems = CitationElement.getItems(el).reduce(\n            (arr, id) => {\n                const item = getItemById(state, id);\n                return item !== undefined ? [...arr, { id, item }] : arr;\n            },\n            <Citation['citationItems']>[],\n        );\n        return {\n            citationID,\n            citationItems,\n            properties: {\n                index,\n                noteIndex: 0,\n            },\n        };\n    });\n}\n\nexport function getCitedItems(state: State): CSL.Data[] {\n    const doc = getEditorDOM(true);\n    return _([...doc.querySelectorAll<HTMLElement>(CitationElement.selector)])\n        .flatMap(CitationElement.getItems)\n        .uniq()\n        .map(_.partial(getItemById, state))\n        .compact()\n        .value();\n}\n\nexport function getFootnotes() {\n    const doc = getEditorDOM();\n    const container = document.createElement('div');\n    const marker = document.createElement('div');\n    const content = document.createElement('div');\n    marker.className = 'abt-footnotes-item__marker';\n    content.className = 'abt-footnotes-item__content';\n    container.appendChild(marker);\n    container.appendChild(content);\n    return [...doc.querySelectorAll<HTMLElement>(FootnoteElement.selector)].map(\n        footnote => {\n            marker.innerHTML = footnote.innerHTML;\n            content.textContent = footnote.dataset.note || '';\n            return {\n                id: `${footnote.id}-ref`,\n                content: container.innerHTML,\n            };\n        },\n    );\n}\n\nexport function getItems(state: State, kind?: 'cited' | 'uncited'): CSL.Data[] {\n    switch (kind) {\n        case 'cited':\n            return getCitedItems(state);\n        case 'uncited':\n            return getUncitedItems(state);\n        default:\n            return clone(state.references);\n    }\n}\n\nexport function getSortedItems(\n    state: State,\n    mode: 'date' | 'publication' | 'title' = 'title',\n    order: 'asc' | 'desc' = 'asc',\n    kind?: 'cited' | 'uncited',\n): CSL.Data[] {\n    return _.orderBy(\n        getItems(state, kind),\n        item => {\n            switch (mode) {\n                case 'date':\n                    const [year, month = 0, day = 1]: number[] = _.get(\n                        item.issued,\n                        '[date-parts][0]',\n                        [-5000],\n                    );\n                    return new Date(year, month, day).toJSON();\n                case 'publication':\n                    return firstTruthyValue(\n                        item,\n                        [\n                            'journalAbbreviation',\n                            'container-title-short',\n                            'container-title',\n                            'publisher',\n                        ],\n                        '~',\n                    );\n                case 'title':\n                default:\n                    return item.title || '~';\n            }\n        },\n        order,\n    );\n}\n\nexport function getItemById(state: State, id: string): CSL.Data | undefined {\n    return clone(state.references.find(item => item.id === id));\n}\n\nexport function getSerializedState({ references, style }: State) {\n    return {\n        meta: {\n            _abt_state: JSON.stringify({ references, style }),\n        },\n    };\n}\n\nexport function getUncitedItems(state: State): CSL.Data[] {\n    return _.differenceWith(\n        state.references,\n        getCitedItems(state),\n        (left, right) => left.id === right.id,\n    );\n}\n","import * as actions from './actions';\nimport { StyleKind } from './constants';\nimport controls from './controls';\nimport reducer from './reducer';\nimport * as resolvers from './resolvers';\nimport * as selectors from './selectors';\n\nexport interface Style {\n    kind: StyleKind;\n    value: string;\n    label: string;\n    shortTitle?: string;\n}\n\nexport interface StyleJSON {\n    renamed: Record<string, string>;\n    styles: Style[];\n}\n\nexport interface SavedState {\n    references: CSL.Data[];\n    style: Style;\n}\n\nexport interface State extends SavedState {\n    citationStyles: StyleJSON;\n}\n\nexport const name = 'abt/data';\n\nexport const config = {\n    actions,\n    controls,\n    reducer,\n    resolvers,\n    selectors,\n};\n\nexport default [name, config] as [string, typeof config];\n","import { IdentifierKind } from 'utils/constants';\n\nimport { Actions } from './constants';\n\nexport function clearSelectedItems() {\n    return {\n        type: Actions.CLEAR_SELECTED_ITEMS,\n    };\n}\n\nexport function setIdentifierKind(kind: IdentifierKind) {\n    return {\n        type: Actions.SET_IDENTIFIER_KIND,\n        kind,\n    };\n}\n\nexport function setSidebarSortMode(mode: 'date' | 'publication' | 'title') {\n    return {\n        type: Actions.SET_SIDEBAR_SORT_MODE,\n        mode,\n    };\n}\n\nexport function setSidebarSortOrder(order: 'asc' | 'desc') {\n    return {\n        type: Actions.SET_SIDEBAR_SORT_ORDER,\n        order,\n    };\n}\n\nexport function toggleItemSelected(id: string) {\n    return {\n        type: Actions.TOGGLE_ITEM_SELECTED,\n        id,\n    };\n}\n","import { Action, combineReducers } from '@wordpress/data';\n\nimport { IdentifierKind } from 'utils/constants';\n\nimport { State } from './';\nimport { Actions } from './constants';\n\nconst ARD_INITIAL_STATE: State['addReferenceDialog'] = {\n    identifierKind: IdentifierKind.DOI,\n};\n\nexport function addReferenceDialog(\n    state = ARD_INITIAL_STATE,\n    action: Action,\n): State['addReferenceDialog'] {\n    switch (action.type) {\n        case Actions.SET_IDENTIFIER_KIND: {\n            return {\n                ...state,\n                identifierKind: action.kind,\n            };\n        }\n        default:\n            return state;\n    }\n}\n\nconst SIDEBAR_INITIAL_STATE: State['sidebar'] = {\n    selectedItems: [],\n    sortMode: 'title',\n    sortOrder: 'asc',\n};\n\nexport function sidebar(\n    state = SIDEBAR_INITIAL_STATE,\n    action: Action,\n): State['sidebar'] {\n    switch (action.type) {\n        case Actions.CLEAR_SELECTED_ITEMS: {\n            return {\n                ...state,\n                selectedItems: [],\n            };\n        }\n        case Actions.SET_SIDEBAR_SORT_MODE: {\n            return {\n                ...state,\n                sortMode: action.mode,\n            };\n        }\n        case Actions.SET_SIDEBAR_SORT_ORDER: {\n            return {\n                ...state,\n                sortOrder: action.order,\n            };\n        }\n        case Actions.TOGGLE_ITEM_SELECTED: {\n            return {\n                ...state,\n                selectedItems: state.selectedItems.includes(action.id)\n                    ? state.selectedItems.filter(id => id !== action.id)\n                    : [...state.selectedItems, action.id],\n            };\n        }\n        default:\n            return state;\n    }\n}\n\nexport default combineReducers({\n    addReferenceDialog,\n    sidebar,\n});\n","import { State } from './';\n\nexport function getIdentifierKind(state: State) {\n    return state.addReferenceDialog.identifierKind;\n}\n\nexport function getSelectedItems(state: State) {\n    return [...state.sidebar.selectedItems];\n}\n\nexport function getSidebarSortMode(state: State) {\n    return state.sidebar.sortMode;\n}\n\nexport function getSidebarSortOrder(state: State) {\n    return state.sidebar.sortOrder;\n}\n","import { IdentifierKind } from 'utils/constants';\n\nimport * as actions from './actions';\nimport reducer from './reducer';\nimport * as selectors from './selectors';\n\nexport interface State {\n    sidebar: {\n        selectedItems: string[];\n        sortMode: 'date' | 'publication' | 'title';\n        sortOrder: 'asc' | 'desc';\n    };\n    addReferenceDialog: {\n        identifierKind: IdentifierKind;\n    };\n}\n\nexport const name = 'abt/ui';\n\nexport const config = {\n    actions,\n    reducer,\n    selectors,\n};\n\nexport default [name, config] as [string, typeof config];\n","import { registerStore } from '@wordpress/data';\n\nimport dataStore from './data';\nimport uiStore from './ui';\n\nregisterStore(...dataStore);\nregisterStore(...uiStore);\n","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","import _ from 'lodash';\n\ntype Widen<T> = T extends string ? string : T extends number ? number : T;\n\nexport function clone<T>(data: T): T {\n    if (data === undefined) {\n        return data;\n    }\n    return JSON.parse(JSON.stringify(data));\n}\n\nexport function firstTruthyValue<T extends Record<string, any>, U>(\n    obj: T,\n    paths: string[],\n    fallback: Widen<U>,\n): Widen<U>;\nexport function firstTruthyValue<T extends Record<string, any>, U>(\n    obj: T,\n    paths: string[],\n): U | undefined;\nexport function firstTruthyValue<T extends Record<string, any>, U>(\n    obj: T,\n    paths: string[],\n    fallback?: Widen<U>,\n) {\n    for (const path of paths) {\n        const val = _.get(obj, path);\n        if (val) {\n            return val;\n        }\n    }\n    return fallback;\n}\n\nexport function swapWith<T>(arr: T[], a: number, b: number): T[] {\n    const list = [...arr];\n    const item = list.splice(a, 1);\n    return [...list.slice(0, b), ...item, ...list.slice(b)];\n}\n","import uuid from 'uuid/v4';\n\nimport { createSelector } from 'utils/dom';\n\nconst OBJECT_REPLACEMENT_CHARACTER = '\\ufffc';\n\ninterface ABTElement {\n    readonly className: string;\n    readonly legacyClassNames: ReadonlyArray<string>;\n    readonly selector: string;\n    create(...args: any): string;\n}\n\n@staticImplements<ABTElement>()\nexport abstract class CitationElement {\n    static readonly className = 'abt-citation';\n    static readonly legacyClassNames: ReadonlyArray<string> = [\n        CitationElement.className,\n        'abt_cite',\n    ];\n    static readonly selector = createSelector(\n        ...CitationElement.legacyClassNames.map(cls => ({\n            classNames: [cls],\n            attributes: {\n                id: true,\n            },\n        })),\n    );\n\n    static create(items: string[]): string {\n        const citation = document.createElement('span');\n        citation.className = CitationElement.className;\n        citation.id = uuid();\n        citation.dataset.items = JSON.stringify(items);\n        citation.contentEditable = 'false';\n        citation.innerText = OBJECT_REPLACEMENT_CHARACTER;\n        return citation.outerHTML;\n    }\n\n    static getItems(el: HTMLElement): string[] {\n        return JSON.parse(el.dataset.items || el.dataset.reflist || '[]');\n    }\n}\n\n@staticImplements<ABTElement>()\nexport abstract class FootnoteElement {\n    static readonly className = 'abt-footnote';\n    static readonly legacyClassNames: ReadonlyArray<string> = [\n        FootnoteElement.className,\n    ];\n    static readonly selector = createSelector(\n        ...FootnoteElement.legacyClassNames.map(cls => ({\n            classNames: [cls],\n            attributes: {\n                id: true,\n            },\n        })),\n    );\n\n    static create(note: string): string {\n        const footnote = document.createElement('span');\n        footnote.className = FootnoteElement.className;\n        footnote.id = uuid();\n        footnote.dataset.note = note;\n        footnote.contentEditable = 'false';\n        footnote.innerText = OBJECT_REPLACEMENT_CHARACTER;\n        return footnote.outerHTML;\n    }\n\n    static createMarker(index: number, marker = ''): string {\n        const markers = ['*', '†', '‡', '§', '¶', '#'];\n        return index >= 0\n            ? FootnoteElement.createMarker(\n                  index - markers.length,\n                  marker + markers[index % markers.length],\n              )\n            : `<sup>${marker}</sup>`;\n    }\n}\n\n// helper for strict types of static properties\nfunction staticImplements<T>() {\n    return (_cons: T) => void 0;\n}\n","module.exports = wp.url;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","interface SelectorData {\n    element?: keyof HTMLElementTagNameMap;\n    id?: string;\n    classNames?: string[];\n    attributes?: Record<string, string | number | boolean>;\n}\n\nexport function createSelector(...selectors: SelectorData[]): string {\n    return selectors\n        .map(({ element, id, classNames = [], attributes = {} }) => {\n            let selector = '';\n            if (element) {\n                selector += `${element}`;\n            }\n            if (id) {\n                selector += `#${id}`;\n            }\n            for (const cls of classNames) {\n                selector += `.${cls}`;\n            }\n            for (const [k, v] of Object.entries(attributes)) {\n                if (typeof v === 'boolean') {\n                    selector += v ? `[${k}]` : '';\n                } else {\n                    selector += `[${k}=\"${v}\"]`;\n                }\n            }\n            return selector;\n        })\n        .join();\n}\n\nexport function getJSONScriptData<T>(id: string): T {\n    const selector = createSelector({\n        element: 'script',\n        id,\n        attributes: { type: 'application/json' },\n    });\n    const script = document.querySelector<HTMLScriptElement>(selector);\n    if (!script) {\n        throw new Error(`Unable to retrieve JSON data using ID \"${id}\"`);\n    }\n    return JSON.parse(script.innerHTML);\n}\n","module.exports = wp.blocks;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n","import { Block, serialize } from '@wordpress/blocks';\nimport { select } from '@wordpress/data';\nimport _ from 'lodash';\n\nimport Processor from 'utils/processor';\n\nconst INVALID_BLOCK_TYPES = ['core/freeform', 'core/html'];\n\nexport function getEditorDOM(excludeInvalid: boolean = false): HTMLDivElement {\n    const doc = document.createElement('div');\n    if (excludeInvalid) {\n        const filteredBlocks = select<Block[]>('core/editor')\n            .getBlocksForSerialization()\n            .filter(\n                block =>\n                    !INVALID_BLOCK_TYPES.includes(block.name) && block.isValid,\n            );\n        doc.innerHTML = serialize(filteredBlocks);\n    } else {\n        doc.innerHTML = select<string>('core/editor').getEditedPostContent();\n    }\n    return doc;\n}\n\nexport function parseBibAttributes({\n    entryspacing,\n    hangingindent,\n    maxoffset,\n    linespacing,\n    secondFieldAlign,\n}: { [k in keyof Processor.BibMeta]?: string }) {\n    return {\n        ...(entryspacing\n            ? { 'data-entryspacing': `${entryspacing}` }\n            : undefined),\n        ...(hangingindent\n            ? { 'data-hangingindent': `${hangingindent}` }\n            : undefined),\n        ...(maxoffset ? { 'data-maxoffset': `${maxoffset}` } : undefined),\n        ...(linespacing ? { 'data-linespacing': `${linespacing}` } : undefined),\n        ...(secondFieldAlign\n            ? { 'data-second-field-align': secondFieldAlign }\n            : undefined),\n    };\n}\n\nexport function stripListItem(item: Element | string): string {\n    if (typeof item === 'string') {\n        const container = document.createElement('div');\n        container.innerHTML = item;\n        const child = container.querySelector('.csl-entry');\n        if (child) {\n            item = child;\n        } else {\n            throw new Error(\n                'Outer HTML of item must be a div with className \"csl-entry\"',\n            );\n        }\n    }\n    const content = item;\n    let toRemove: Element[] = [];\n    for (const el of item.children) {\n        if (el.classList.contains('csl-indent')) {\n            break;\n        }\n        if (el.classList.contains('csl-left-margin')) {\n            toRemove = [...toRemove, el];\n            continue;\n        }\n        if (el.classList.contains('csl-right-inline')) {\n            el.outerHTML = el.innerHTML;\n        }\n    }\n    toRemove.forEach(el => content.removeChild(el));\n    return content.innerHTML.trim();\n}\n","function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nmodule.exports = _nonIterableSpread;","import { addQueryArgs } from '@wordpress/url';\n\ndeclare const _abt_nonce: string;\n\nexport async function fetchAjax(\n    action: string,\n    body?: Record<string, string | number | boolean>,\n): Promise<Response> {\n    return fetch(top.ajaxurl, {\n        method: 'POST',\n        headers: {\n            'Content-type': 'application/x-www-form-urlencoded',\n        },\n        body: addQueryArgs(undefined, {\n            /**\n             * TODO: remove this when gutenberg 2.3.3 merges\n             * @see: https://github.com/WordPress/gutenberg/pull/12803\n             */\n            _: '',\n            _wpnonce: _abt_nonce,\n            action,\n            ...body,\n        }),\n        credentials: 'same-origin',\n    });\n}\n","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","function _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nmodule.exports = _nonIterableRest;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","module.exports = CSL;","import _ from 'lodash';\n\ninterface CacheJSON<T> {\n    [k: string]: {\n        expires: number;\n        data: Record<string, T>;\n    };\n}\n\ninterface StorageFallback extends Storage {\n    _value: Map<string, string>;\n}\n\nabstract class AbstractCache<T> {\n    private readonly PREFIX = 'ABT_CACHE_';\n    private readonly VERSION = 'v1.0';\n    private readonly EXPIRES: number;\n    private readonly ITEM_KEY: string;\n    private readonly KEY = `${this.PREFIX}${this.VERSION}`;\n    private readonly _cache = this.storageIsAvailable()\n        ? top.localStorage\n        : this.createFallbackStorage();\n\n    constructor(key: string, daysTilExpiration: number = 30) {\n        const ONE_DAY = 86400000;\n        this.ITEM_KEY = key;\n        this.EXPIRES = Date.now() + ONE_DAY * daysTilExpiration;\n        const { KEY, PREFIX } = this;\n\n        // Purge old cache versions\n        Object.keys(this._cache)\n            .filter(k => k.startsWith(PREFIX) && k !== KEY)\n            .forEach(k => this._cache.removeItem(k));\n    }\n\n    abstract async fetchItem(key: string): Promise<T>;\n\n    getItem(key: string): T | null {\n        return this.cache[key] || null;\n    }\n    removeItem(key: string): void {\n        this.cache = _.omit(this.cache, key);\n    }\n    setItem(key: string, value: T): void {\n        this.cache = {\n            ...this.cache,\n            [key]: value,\n        };\n    }\n\n    private get cache(): Record<string, T> {\n        const { EXPIRES: expires, ITEM_KEY, KEY } = this;\n        const value: CacheJSON<T> = JSON.parse(\n            this._cache.getItem(KEY) || '{}',\n        );\n        let item = value[ITEM_KEY];\n        if (!item || item.expires < Date.now()) {\n            item = {\n                expires,\n                data: {},\n            };\n            this._cache.setItem(\n                KEY,\n                JSON.stringify({\n                    ...value,\n                    [ITEM_KEY]: { ...item },\n                }),\n            );\n        }\n        return { ...item.data };\n    }\n    private set cache(data: Record<string, T>) {\n        const { ITEM_KEY, KEY } = this;\n        const value: CacheJSON<T> = JSON.parse(\n            this._cache.getItem(KEY) || '{}',\n        );\n        const item = value[ITEM_KEY];\n        this._cache.setItem(\n            KEY,\n            JSON.stringify({ ...value, [ITEM_KEY]: { ...item, data } }),\n        );\n    }\n\n    private storageIsAvailable(): boolean {\n        const TEST_KEY = '__storage_test__';\n        try {\n            const storage = window.localStorage;\n            storage.setItem(TEST_KEY, 'test');\n            storage.removeItem(TEST_KEY);\n            return true;\n        } catch {\n            return false;\n        }\n    }\n\n    private createFallbackStorage(): StorageFallback {\n        return {\n            _value: new Map(),\n            get length() {\n                return this._value.size;\n            },\n            clear() {\n                this._value.clear();\n            },\n            getItem(key) {\n                return this._value.get(key) || null;\n            },\n            key(index) {\n                return [...this._value.keys()][index] || null;\n            },\n            removeItem(key) {\n                this._value.delete(key);\n            },\n            setItem(key, value) {\n                this._value.set(key, value);\n            },\n        };\n    }\n}\n\nexport const localeCache = new class extends AbstractCache<string> {\n    private parser = new DOMParser();\n\n    async fetchItem(style: string): Promise<string> {\n        const xml = this.parser.parseFromString(style, 'application/xml');\n        const styleNode = xml.querySelector('style');\n        if (xml.querySelector('parsererror')) {\n            throw new Error('Invalid style XML');\n        }\n        if (!styleNode) {\n            throw new Error('CSL style is not valid');\n        }\n        const localeId = styleNode.getAttribute('default-locale') || 'en-US';\n        const response = await fetch(\n            `https://raw.githubusercontent.com/citation-style-language/locales/master/locales-${localeId}.xml`,\n        );\n        if (!response.ok) {\n            throw new Error(response.statusText);\n        }\n        const locale = await response.text();\n        this.setItem(localeId, locale);\n        return locale;\n    }\n}('locales');\n\nexport const styleCache = new class extends AbstractCache<string> {\n    async fetchItem(styleId: string): Promise<string> {\n        const cached = this.getItem(styleId);\n        if (cached !== null) {\n            return cached;\n        }\n        const response = await fetch(\n            `https://raw.githubusercontent.com/citation-style-language/styles/master/${styleId}.csl`,\n        );\n        if (!response.ok) {\n            throw new Error(response.statusText);\n        }\n        const style = await response.text();\n        this.setItem(styleId, style);\n        return style;\n    }\n}('styles');\n","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\n\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto\n// implementation. Also, find the complete implementation of crypto on IE11.\nvar getRandomValues = (typeof(crypto) != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto)) ||\n                      (typeof(msCrypto) != 'undefined' && typeof window.msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto));\n\nif (getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\n  module.exports = function whatwgRNG() {\n    getRandomValues(rnds8);\n    return rnds8;\n  };\n} else {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n\n  module.exports = function mathRNG() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n  return ([bth[buf[i++]], bth[buf[i++]], \n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]],\n\tbth[buf[i++]], bth[buf[i++]],\n\tbth[buf[i++]], bth[buf[i++]]]).join('');\n}\n\nmodule.exports = bytesToUuid;\n","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;"],"sourceRoot":""}